{"mappings":"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","sources":["package.json","src/modules/defaultCommands.js","src/modules/textTerminal.js","src/modules/template.js","src/modules/cloneCommandEl.js"],"sourcesContent":["{\n  \"name\": \"text-terminal\",\n  \"version\": \"0.2.0\",\n  \"description\": \"A simple, extendable terminal interface for the web.\",\n  \"repository\": \"https://github.com/desholmes/text-terminal\",\n  \"scripts\": {\n    \"clean\": \"rm -rf ./dist/*.css ./dist/*.map ./dist/*.js \",\n    \"start\": \"npm run clean && parcel --no-cache --lazy ./src/index.html\",\n    \"build\": \"npm run clean && parcel build ./src/scss/text-terminal.scss && parcel build ./src/modules/textTerminal.js\",\n    \"lint\": \"prettier --check .\",\n    \"lint-fix\": \"prettier --write .\"\n  },\n  \"author\": \"Des Holmes https://github.com/desholmes\",\n  \"license\": \"MIT\",\n  \"devDependencies\": {\n    \"@parcel/transformer-sass\": \"2.0.0-rc.0\",\n    \"@parcel/transformer-json\": \"2.0.0-rc.0\",\n    \"prettier\": \"2.1.2\",\n    \"parcel\": \"2.0.0-rc.0\",\n    \"sass\": \"1.42.1\"\n  }\n}\n","import Package from \"../../package.json\";\n\nexport default {\n  clear: (terminal) => terminal.clear(),\n\n  version: (terminal) => { \n    console.log(Package);\n    terminal.output(`Text Terminal v${Package.version}`)\n  },\n};\n","import template from \"./template\";\nimport defaultCommands from \"./defaultCommands\";\nimport cloneCommand from \"./cloneCommandEl\";\n\nclass TextTerminal {\n  #id = \"TextTerminal\";\n  dom = {};\n  commands = {};\n  history = [];\n  historyCursor = 0;\n  prompt;\n  separator;\n  theme;\n  welcome;\n\n  constructor(configProps = {}) {\n    const {\n      containerId = \"text-terminal\",\n      commands = {},\n      prompt = \"\",\n      theme = \"dark\",\n      welcome = \"Welcome!\",\n      separator = \":\",\n    } = configProps;\n\n    const containerEl = document.getElementById(containerId);\n\n    if (!containerEl) {\n      throw Error(`Container #${containerId} does not exist!`);\n    }\n\n    this.commands = Object.assign({}, commands, defaultCommands);\n    this.history = localStorage[this.#id]\n      ? JSON.parse(localStorage[this.#id])\n      : [];\n    this.historyCursor = this.history.length;\n    this.prompt = prompt;\n    this.separator = separator;\n    this.theme = theme;\n    this.welcome = welcome;\n\n    this.createDom(containerEl);\n    this.addListeners();\n\n    if (this.welcome) this.output(this.welcome);\n  }\n\n  addListeners() {\n    this.dom.output.addEventListener(\n      \"DOMSubtreeModified\",\n      () => {\n        setTimeout(() => this.dom.input.scrollIntoView(), 10);\n      },\n      false\n    );\n\n    if (window) {\n      window.addEventListener(\"click\", () => this.dom.input.focus(), false);\n    }\n\n    this.dom.output.addEventListener(\n      \"click\",\n      (event) => event.stopPropagation(),\n      false\n    );\n\n    this.dom.command.addEventListener(\n      \"click\",\n      () => this.dom.input.focus(),\n      false\n    );\n\n    this.dom.input.addEventListener(\"keyup\", this.onKeyUp, false);\n    this.dom.input.addEventListener(\"keydown\", this.onKeyDown, false);\n  }\n\n  clear() {\n    this.dom.output.innerHTML = \"\";\n    this.resetCommand();\n  }\n\n  createDom(containerEl) {\n    containerEl.classList.add(this.#id, this.theme);\n    containerEl.insertAdjacentHTML(\n      \"beforeEnd\",\n      template(this.prompt, this.separator)\n    );\n\n    this.dom = {\n      container: containerEl.querySelector(\".container\"),\n      output: containerEl.querySelector(\"output\"),\n      command: containerEl.querySelector(\".command\"),\n      input: containerEl.querySelector(\".command .input\"),\n      prompt: containerEl.querySelector(\".command .prompt\"),\n    };\n  }\n\n  onKeyDown = (event) => {\n    const commandInput = this.dom.input.value.trim();\n\n    if (event.keyCode !== 13 || !commandInput) {\n      return;\n    }\n\n    const [command, ...parameters] = commandInput.split(\" \");\n\n    // Add commands to history\n    this.history.push(commandInput);\n    localStorage[this.#id] = JSON.stringify(this.history);\n    this.historyCursor = this.history.length;\n\n    // Clone command as a new output line\n    this.dom.output.appendChild(cloneCommand(this.dom.command));\n\n    this.dom.input.value = \"\";\n\n    // Dispatch command\n    if (Object.keys(this.commands).includes(command)) {\n      const callback = this.commands[command];\n      if (callback) {\n        callback(this, parameters);\n      }\n    } else {\n      this.output(`<b>${command}</b>: command not found.`);\n    }\n  };\n\n  onKeyUp = (event) => {\n    this.dom.input.focus();\n    event.stopPropagation();\n    event.preventDefault();\n\n    // ESC\n    if (event.keyCode === 27) {\n      this.dom.input.value = \"\";\n      event.stopPropagation();\n      event.preventDefault();\n    }\n\n    if (event.keyCode === 38 || event.keyCode === 40) {\n      // UP key\n      if (event.keyCode === 38 && this.historyCursor > 0) {\n        this.historyCursor -= 1;\n      }\n\n      // DOWN key\n      if (\n        event.keyCode === 40 &&\n        this.historyCursor < this.history.length - 1\n      ) {\n        this.historyCursor -= 1;\n      }\n\n      if (this.history[this.historyCursor]) {\n        this.dom.input.value = this.history[this.historyCursor];\n      }\n    }\n  };\n\n  output(command = \"&nbsp;\") {\n    this.dom.output.insertAdjacentHTML(\"beforeEnd\", `<span>${command}</span>`);\n    this.resetCommand();\n  }\n\n  resetCommand = () => {\n    this.dom.input.value = \"\";\n    this.dom.command.classList.remove(\"input\");\n  };\n}\n\nif (window) {\n  window.TextTerminal = TextTerminal;\n}\n\nexport default TextTerminal;\n","export default (prompt, separator) => `\n  <div class=\"container\">\n    <output></output>\n    <div class=\"command\">\n      <div class=\"prompt\">${prompt}${separator}</div>\n      <input class=\"input\" spellcheck=\"false\" autocapitalize=\"off\" autofocus />\n    </div>\n  </div>\n`;\n","export default (el) => {\n  const line = el.cloneNode(true);\n  const input = line.querySelector(\".input\");\n\n  input.autofocus = false;\n  input.readOnly = true;\n  input.insertAdjacentHTML(\"beforebegin\", input.value);\n  input.parentNode.removeChild(input);\n  line.classList.add(\"line\");\n\n  return line;\n};\n"],"names":["$85683dcb793c7f42$exports","JSON","parse","$f3d38cccc6a96ec7$export$9099ad97b570f7c","clear","terminal","version","console","log","$parcel$interopDefault","output","$91570aec5420140a$var$TextTerminal","dom","commands","history","historyCursor","prompt","separator","theme","welcome","configProps","containerId","containerEl1","document","getElementById","Error","Object","assign","localStorage","this","id","length","createDom","addListeners","addEventListener","setTimeout","input","scrollIntoView","window","focus","event","stopPropagation","command","onKeyUp","onKeyDown","innerHTML","resetCommand","containerEl","classList","add","insertAdjacentHTML","container","querySelector","commandInput","value","trim","keyCode","parameters","split","push","stringify","appendChild","el","line","cloneNode","autofocus","readOnly","parentNode","removeChild","$e7a19aa391e70f60$export$9099ad97b570f7c","keys","includes","callback","preventDefault","remove","TextTerminal"],"version":3,"file":"textTerminal.js.map"}