{"version":3,"sources":["modules/template.js","../package.json","modules/defaultCommands.js","modules/cloneCommandEl.js","modules/textTerminal.js","index.js"],"names":["prompt","separator","module","exports","name","version","description","repository","scripts","start","build","lint","author","license","devDependencies","prettier","sass","clear","terminal","output","package","el","line","cloneNode","input","querySelector","autofocus","readOnly","insertAdjacentHTML","value","parentNode","removeChild","classList","add","TextTerminal","configProps","event","commandInput","trim","keyCode","split","command","parameters","Object","history","push","localStorage","JSON","stringify","historyCursor","length","appendChild","keys","commands","includes","callback","focus","stopPropagation","preventDefault","remove","containerId","theme","welcome","containerEl","document","getElementById","Error","assign","defaultCommands","parse","createDom","addListeners","addEventListener","setTimeout","scrollIntoView","window","onKeyUp","onKeyDown","container","resetCommand"],"mappings":"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","file":"TextTerminal-0.1.0.js","sourceRoot":"../src","sourcesContent":["export default (prompt, separator) => `\n  <div class=\"container\">\n    <output></output>\n    <div class=\"command\">\n      <div class=\"prompt\">${prompt}${separator}</div>\n      <input class=\"input\" spellcheck=\"false\" autofocus />\n    </div>\n  </div>\n`;\n","module.exports={name:\"text-terminal\",version:\"0.1.0\",description:\"A simple, extendable terminal interface for the web.\",repository:\"https://github.com/desholmes/text-terminal\",scripts:{start:\"parcel ./src/index.html\",build:\"parcel build ./src/styles/main.scss --out-file TextTerminal-$npm_package_version.css  && parcel build ./src/index.js --out-file TextTerminal-$npm_package_version.js\",lint:\"prettier --check .\",\"lint-fix\":\"prettier --write .\"},author:\"Des Holmes https://github.com/desholmes\",license:\"MIT\",devDependencies:{\"parcel-bundler\":\"^1.12.4\",prettier:\"2.1.2\",sass:\"^1.28.0\"}};","import package from \"../../package.json\";\n\nexport default {\n  clear: (terminal) => terminal.clear(),\n\n  version: (terminal) => terminal.output(`Text Terminal v${package.version}`),\n};\n","export default (el) => {\n  const line = el.cloneNode(true);\n  const input = line.querySelector(\".input\");\n\n  input.autofocus = false;\n  input.readOnly = true;\n  input.insertAdjacentHTML(\"beforebegin\", input.value);\n  input.parentNode.removeChild(input);\n  line.classList.add(\"line\");\n\n  return line;\n};\n","import template from \"./template\";\nimport { defaultCommands } from \"./defaultCommands\";\nimport cloneCommand from \"./cloneCommandEl\";\n\nclass TextTerminal {\n  #id = \"TextTerminal\";\n  #dom = {};\n  commands = {};\n  history = [];\n  historyCursor = 0;\n  prompt;\n  separator;\n  theme;\n  welcome;\n\n  constructor(configProps = {}) {\n    const {\n      containerId = \"text-terminal\",\n      commands = {},\n      prompt = \"\",\n      theme = \"dark\",\n      welcome = \"Welcome!\",\n      separator = \":\",\n    } = configProps;\n\n    const containerEl = document.getElementById(containerId);\n\n    if (!containerEl) {\n      throw Error(`Container #${containerId} does not exist!`);\n    }\n\n    this.commands = Object.assign({}, commands, defaultCommands);\n    this.history = localStorage[this.#id]\n      ? JSON.parse(localStorage[this.#id])\n      : [];\n    this.historyCursor = this.history.length;\n    this.prompt = prompt;\n    this.separator = separator;\n    this.theme = theme;\n    this.welcome = welcome;\n\n    this.createDom(containerEl);\n    this.addListeners();\n\n    if (this.welcome) this.output(this.welcome);\n  }\n\n  addListeners() {\n    this.#dom.output.addEventListener(\n      \"DOMSubtreeModified\",\n      () => {\n        setTimeout(() => this.#dom.input.scrollIntoView(), 10);\n      },\n      false\n    );\n\n    if (window) {\n      window.addEventListener(\"click\", () => this.#dom.input.focus(), false);\n    }\n\n    this.#dom.output.addEventListener(\n      \"click\",\n      (event) => event.stopPropagation(),\n      false\n    );\n\n    this.#dom.command.addEventListener(\n      \"click\",\n      () => this.#dom.input.focus(),\n      false\n    );\n\n    this.#dom.input.addEventListener(\"keyup\", this.onKeyUp, false);\n    this.#dom.input.addEventListener(\"keydown\", this.onKeyDown, false);\n  }\n\n  createDom(containerEl) {\n    containerEl.classList.add(this.#id, this.theme);\n    containerEl.insertAdjacentHTML(\n      \"beforeEnd\",\n      template(this.prompt, this.separator)\n    );\n\n    this.#dom = {\n      container: containerEl.querySelector(\".container\"),\n      output: containerEl.querySelector(\"output\"),\n      command: containerEl.querySelector(\".command\"),\n      input: containerEl.querySelector(\".command .input\"),\n      prompt: containerEl.querySelector(\".command .prompt\"),\n    };\n  }\n\n  onKeyDown = (event) => {\n    const commandInput = this.#dom.input.value.trim();\n\n    if (event.keyCode !== 13 || !commandInput) {\n      return;\n    }\n\n    const [command, ...parameters] = commandInput.split(\" \");\n\n    // if (state.prompt) {\n    //   state.prompt = false;\n    //   this.onAskCallback(command);\n    //   this.setPrompt();\n    //   this.resetCommand();\n    //   return;\n    // }\n\n    // Add commands to history\n    this.history.push(commandInput);\n    localStorage[this.#id] = JSON.stringify(this.history);\n    this.historyCursor = this.history.length;\n\n    // Clone command as a new output line\n    this.#dom.output.appendChild(cloneCommand(this.#dom.command));\n\n    this.#dom.input.value = \"\";\n\n    // Dispatch command\n    if (Object.keys(this.commands).includes(command)) {\n      const callback = this.commands[command];\n      if (callback) {\n        callback(this, parameters);\n      }\n      // if (onInputCallback) {\n      //   onInputCallback(command, parameters);\n      // }\n    } else {\n      this.output(`<b>${command}</b>: command not found.`);\n    }\n  };\n\n  onKeyUp = (event) => {\n    this.#dom.input.focus();\n    event.stopPropagation();\n    event.preventDefault();\n\n    // ESC\n    if (event.keyCode === 27) {\n      this.#dom.input.value = \"\";\n      event.stopPropagation();\n      event.preventDefault();\n    }\n\n    if (event.keyCode === 38 || event.keyCode === 40) {\n      // UP key\n      if (event.keyCode === 38 && this.historyCursor > 0) {\n        this.historyCursor -= 1;\n      }\n\n      // DOWN key\n      if (\n        event.keyCode === 40 &&\n        this.historyCursor < this.history.length - 1\n      ) {\n        this.historyCursor -= 1;\n      }\n\n      if (this.history[this.historyCursor]) {\n        this.#dom.input.value = this.history[this.historyCursor];\n      }\n    }\n  };\n\n  output(command = \"&nbsp;\") {\n    this.#dom.output.insertAdjacentHTML(\"beforeEnd\", `<span>${command}</span>`);\n    this.resetCommand();\n  }\n\n  resetCommand = () => {\n    this.#dom.input.value = \"\";\n    this.#dom.command.classList.remove(\"input\");\n  };\n}\n\nif (window) {\n  window.TextTerminal = TextTerminal;\n}\n\nexport default TextTerminal;\n","import TextTerminal from \"./modules/textTerminal\";\n\nexport { TextTerminal };\n"]}