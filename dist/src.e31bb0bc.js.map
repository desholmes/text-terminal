{"version":3,"sources":["modules/template.js","../package.json","modules/defaultCommands.js","modules/cloneCommandEl.js","modules/textTerminal.js","index.js"],"names":["prompt","separator","module","exports","clear","terminal","version","output","package","el","line","cloneNode","input","querySelector","autofocus","readOnly","insertAdjacentHTML","value","parentNode","removeChild","classList","add","TextTerminal","configProps","event","commandInput","trim","keyCode","split","command","parameters","history","push","localStorage","JSON","stringify","historyCursor","length","appendChild","Object","keys","commands","includes","callback","focus","stopPropagation","preventDefault","remove","scrollIntoView","containerId","theme","welcome","containerEl","document","getElementById","Error","assign","defaultCommands","parse","createDom","addListeners","addEventListener","setTimeout","window","onKeyUp","onKeyDown","container","resetCommand","config"],"mappings":"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","file":"src.e31bb0bc.js","sourceRoot":"../src","sourcesContent":["export default (prompt, separator) => (`\n  <div class=\"container\">\n    <output></output>\n    <div class=\"command\">\n      <div class=\"prompt\">${prompt}${separator}</div>\n      <input class=\"input\" spellcheck=\"false\" autofocus />\n    </div>\n  </div>\n`);","module.exports = {\n  \"name\": \"text-term\",\n  \"version\": \"0.1.0\",\n  \"description\": \"\",\n  \"main\": \"index.js\",\n  \"scripts\": {\n    \"start\": \"parcel ./src/index.html\",\n    \"build\": \"parcel build ./src/index.html\"\n  },\n  \"author\": \"\",\n  \"license\": \"MIT\",\n  \"devDependencies\": {\n    \"parcel-bundler\": \"^1.12.4\",\n    \"sass\": \"^1.28.0\"\n  }\n}\n;","import package from '../../package.json';\n\nexport default {\n  clear: terminal => terminal.clear(),\n\n  version: terminal => terminal.output(`Text Terminal v${package.version}`),\n\n};","export default (el) => {\n    const line = el.cloneNode(true);\n    const input = line.querySelector('.input');\n  \n    input.autofocus = false;\n    input.readOnly = true;\n    input.insertAdjacentHTML('beforebegin', input.value);\n    input.parentNode.removeChild(input);\n    line.classList.add('line');\n  \n    return line;\n  };","import template from \"./template\";\nimport { defaultCommands } from \"./defaultCommands\";\nimport cloneCommand from \"./cloneCommandEl\";\n\nclass TextTerminal {\n  #id = \"TextTerminal\";\n  #dom = {};\n  commands = {};\n  history = [];\n  historyCursor = 0;\n  prompt;\n  separator;\n  theme;\n  welcome;\n\n  constructor(configProps = {}) {\n    const {\n      containerId = \"text-terminal\",\n      commands = {},\n      prompt = \"\",\n      theme = \"dark\",\n      welcome = \"Welcome!\",\n      separator = \":\",\n    } = configProps;\n\n    const containerEl = document.getElementById(containerId);\n\n    if (!containerEl) {\n      throw Error(`Container #${containerId} does not exist!`);\n    }\n\n    this.commands = Object.assign({}, commands, defaultCommands);\n    this.history = localStorage[this.#id]\n      ? JSON.parse(localStorage[this.#id])\n      : [];\n    this.historyCursor = this.history.length;\n    this.prompt = prompt;\n    this.separator = separator;\n    this.theme = theme;\n    this.welcome = welcome;\n\n    this.createDom(containerEl);\n    this.addListeners();\n\n    if (this.welcome) this.output(this.welcome);\n  }\n\n  addListeners() {\n    this.#dom.output.addEventListener(\n      \"DOMSubtreeModified\",\n      () => {\n        setTimeout(() => this.#dom.input.scrollIntoView(), 10);\n      },\n      false\n    );\n\n    if (window) {\n      window.addEventListener(\"click\", () => this.#dom.input.focus(), false);\n    }\n\n    this.#dom.output.addEventListener(\n      \"click\",\n      (event) => event.stopPropagation(),\n      false\n    );\n\n    this.#dom.command.addEventListener(\n      \"click\",\n      () => this.#dom.input.focus(),\n      false\n    );\n\n    this.#dom.input.addEventListener(\"keyup\", this.onKeyUp, false);\n    this.#dom.input.addEventListener(\"keydown\", this.onKeyDown, false);\n  }\n\n  createDom(containerEl) {\n    containerEl.classList.add(this.#id);\n    containerEl.insertAdjacentHTML(\n      \"beforeEnd\",\n      template(this.prompt, this.separator)\n    );\n    document.querySelector(\"body\").classList.add(this.theme);\n\n    this.#dom = {\n      container: containerEl.querySelector(\".container\"),\n      output: containerEl.querySelector(\"output\"),\n      command: containerEl.querySelector(\".command\"),\n      input: containerEl.querySelector(\".command .input\"),\n      prompt: containerEl.querySelector(\".command .prompt\"),\n    };\n  }\n\n  onKeyDown = (event) => {\n    const commandInput = this.#dom.input.value.trim();\n\n    if (event.keyCode !== 13 || !commandInput) {\n      return;\n    }\n\n    const [command, ...parameters] = commandInput.split(\" \");\n\n    // if (state.prompt) {\n    //   state.prompt = false;\n    //   this.onAskCallback(command);\n    //   this.setPrompt();\n    //   this.resetCommand();\n    //   return;\n    // }\n\n    // Add commands to history\n    this.history.push(commandInput);\n    localStorage[this.#id] = JSON.stringify(this.history);\n    this.historyCursor = this.history.length;\n\n    // Clone command as a new output line\n    this.#dom.output.appendChild(cloneCommand(this.#dom.command));\n\n    this.#dom.input.value = \"\";\n\n    // Dispatch command\n    if (Object.keys(this.commands).includes(command)) {\n      const callback = this.commands[command];\n      if (callback) {\n        callback(this, parameters);\n      }\n      // if (onInputCallback) {\n      //   onInputCallback(command, parameters);\n      // }\n    } else {\n      this.output(`<u>${command}</u>: command not found.`);\n    }\n  };\n\n  onKeyUp = (event) => {\n    this.#dom.input.focus();\n    event.stopPropagation();\n    event.preventDefault();\n\n    // ESC\n    if (event.keyCode === 27) {\n      this.#dom.input.value = \"\";\n      event.stopPropagation();\n      event.preventDefault();\n    }\n\n    if (event.keyCode === 38 || event.keyCode === 40) {\n      // UP key\n      if (event.keyCode === 38 && this.historyCursor > 0) {\n        this.historyCursor -= 1;\n      }\n\n      // DOWN key\n      if (\n        event.keyCode === 40 &&\n        this.historyCursor < this.history.length - 1\n      ) {\n        this.historyCursor -= 1;\n      }\n\n      if (this.history[this.historyCursor]) {\n        this.#dom.input.value = this.history[this.historyCursor];\n      }\n    }\n  };\n\n  output(command = \"&nbsp;\") {\n    this.#dom.output.insertAdjacentHTML(\"beforeEnd\", `<span>${command}</span>`);\n    this.resetCommand();\n  }\n\n  resetCommand = () => {\n    this.#dom.input.value = \"\";\n    this.#dom.command.classList.remove(\"input\");\n    // DOM.command.classList.remove('hidden');\n    if (this.#dom.input.scrollIntoView) {\n      this.#dom.input.scrollIntoView();\n    }\n  };\n}\n\nif (window) {\n  window.TextTerminal = TextTerminal;\n}\n\nexport default TextTerminal;\n","import TextTerminal from './modules/textTerminal';\n\nconst config = {\n    prompt:\"Bash\",\n    theme: \"sunset\"\n};\n\nconst terminal = new TextTerminal(config);"]}